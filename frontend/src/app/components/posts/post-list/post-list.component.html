



<div class="flex flex-row items-center gap-x-2 mt-5">
  <div class="drawer w-fit">
    <input id="my-drawer" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content">    
      <label for="my-drawer" class="btn drawer-button">Filtrer par:</label>
    </div> 

    <div class="drawer-side z-50">
      <label for="my-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
      <ul class="menu p-4 w-80 min-h-full bg-base-200 text-base-content">
        @for(theme of themes; track theme.id){
          <li (click)="onThemeSelect(theme)" class="rounded-box" [class.bg-gray-400]="theme.id === activeTheme?.id"><a class="hover:bg-primary-100">{{ theme.name }}</a></li>
        }        
      </ul>
    </div>
  </div>

  @if(activeTheme){
    <button class="btn bg-purple-200 h-12">
      <div class="flex flex-row flex-nowrap items-stretch gap-y-0" (click)="removeActiveTheme()">
        <div class="">{{activeTheme.name}}</div>
        <i class="fa-solid fa-xmark ml-4"></i>
      </div> 
    </button>
  } 
</div>




<div class="flex flex-row items-center gap-x-2 mt-5">
  <button class="btn" (click)="expandAll()">Tout voir</button>
  <button class="btn" (click)="collapseAll()">Tout fermer</button>

  <app-search-input class="ml-auto"></app-search-input>
</div>

@if (vm; as vm) {
  <cdk-accordion class="flex flex-col gap-y-8 mt-8" #accordion [multi]="true">
    @for (category of vm.categories; track category.key) {
      <cdk-accordion-item #accordionItem="cdkAccordionItem">
      
        <button class="btn flex flex-row bg-purple-300 h-16" (click)="accordionItem.toggle()">
          <div class="flex flex-col flex-nowrap items-start gap-y-0 ">
            <div class="text-xs text-stone-600">{{ category.categoryName | titlecase }} ></div>
            <div class="text-xl ml-4">{{ category.themeName | titlecase }}</div>
          </div>        
          <div class="badge badge-sm badge-ghost ml-2">{{ category.postCount }}</div>
        </button>    

        <div class="ml-8 mt-2" [style.display]="accordionItem.expanded ? '' : 'none'">
          <div class="flex flex-col gap-y-2 ml-8 mt-2" [style.display]="accordionItem.expanded ? '' : 'none'">
            @for (post of category.posts; track post.id) {
              <app-post-card [post]="post" [showStatistics]="true" [showTags]="false" [routerLink]="[post.id]"></app-post-card>
            }
          </div>
        </div>
      </cdk-accordion-item>
    } @empty {
      <div class="text-center">Aucune donn√©es disponibles</div>
    }
  </cdk-accordion>
} @else {
  loading...
}