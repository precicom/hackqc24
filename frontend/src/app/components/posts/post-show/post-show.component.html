<div class="flex flex-col w-full px-3 h-full relative">
  <p [routerLink]="['/..']">retour</p>

  <div class="overflow-y-auto mt-4 grow">
    @if (post; as post) {
      <div class="flex flex-col gap-y-3">
        <div class="flex flex-col">
          <p class="text-lg">Anonyme</p>
          <p class="text-xs">{{ post.created_at | timeDiffPro }}</p>
        </div>

        <p [class.line-clamp-2]="clampText" (click)="unClampText()">
          {{ post.content_text }}
        </p>

        @if (post.rejection_reason) {
          <div
            class="w-full border border-x-transparent border-b-transparent border-t-gray-950 py-1"
          >
            <p>
              {{ post.rejection_reason }}
            </p>
          </div>
          }

        <div class="flex flex-row">
          <div class="flex flex-row items-center mr-auto">
            <i class="fa-regular fa-heart fa-lg"></i>
            <p class="ml-1">{{ post | postUpVoteCount }}</p>
          </div>

          <div class="flex flex-row items-center ml-auto">
            <p class="ml-1">{{ post | postCommentCount }} commentaires</p>
          </div>
        </div>

        <div class="w-full border border-x-transparent border-y-gray-950 py-1">
          <button class="w-6/12 h-10 hover:bg-neutral-300">
            <i class="fa-regular fa-heart fa-lg"></i>
            J'aime
          </button>
          <button class="w-6/12 h-10 hover:bg-neutral-300">
            <i class="fa-regular fa-comment fa-lg"></i>
            Commenter
          </button>
        </div>
      </div>
    } @else {
      loading...
    }

    @if(comments; as comments){
      <div class="flex flex-col gap-y-3 mt-3">
        @for(comment of comments | sortBy: 'created_at':'reverse'; track comment.id){
          <app-comment-show [comment]="comment"></app-comment-show>
        }
      </div>     
    }@else {
      loading comments...
    }

    <div class="absolute left-0 right-0 bottom-0 p-2 border border-transparent border-t-gray-950 bg-white">
      <div class="flex flex-row items-center h-full w-full">
        <label class="block">
          @if(file){
            <img #imagePreview src="" class="h-12 cursor-pointer"/>    
          }@else {
            <i class="fa-light fa-image fa-2x p-2 rounded-lg hover:bg-neutral-300 cursor-pointer"></i>
          }    
          
          <input #fileInput type="file" class="absolute invisible w-0 h-0" />
        </label>

        <textarea #textArea class="textarea ml-2 grow" placeholder="Bio"></textarea>
        <i (click)="submit(fileInput, textArea)" class="fa-solid fa-paper-plane-top p-3 rounded-lg hover:bg-neutral-300 cursor-pointer ml-2"></i>
      </div>

      <!-- <div class="text-xs" [class.mt-4]="file?.name">{{ file?.name }}</div> -->
    </div>
  </div>
</div>
